@using System.Security.Claims
@model JobPortal.Models.PaginationViewModel

<div class="job-listings">
    <h2>Latest Jobs</h2>
    <div class="grid">
        @foreach (var job in Model.Jobs)
        {
            <div class="job-card">
                <a asp-action="Details" asp-route-id="@job.Id" class="job-card-link">
                    @if (!string.IsNullOrEmpty(job.Employer?.Logo))
                    {
                        <img src="@job.Employer.Logo" class="company-logo" alt="@job.Employer.CompanyName logo">
                    }
                    <div class="job-info">
                        <h3>@job.Title</h3>
                        <p class="company">@job.Employer?.CompanyName</p>
                        <div class="meta">
                            <span>📍 @job.Location</span>
                            <span>💰 @job.Salary</span>
                            <span>📅 @job.PostedDate.ToString("MMM dd, yyyy")</span>
                        </div>
                    </div>
                </a>

                @{
                    var userId = User.Identity.IsAuthenticated ?
                    int.Parse(User.FindFirstValue(ClaimTypes.NameIdentifier)) : 0;
                }

                @if (User.IsInRole("Admin") || (User.IsInRole("Employer") && job.Employer?.UserId == userId))
                {
                    <div class="job-actions">
                        <a asp-action="Edit" asp-route-id="@job.Id" class="btn btn-sm btn-primary">Edit</a>
                        <form asp-action="Delete" method="post"
                              onsubmit="return confirm('Are you sure you want to delete this job?');">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="id" value="@job.Id" />
                            <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                        </form>
                    </div>
                }
            </div>
        }
    </div>
</div>

@* Render the pagination controls *@
@Html.Partial("_Pagination", Model)

@* <style> *@
@*     .job-card { *@
@*         position: relative; *@
@*         padding: 1.5rem; *@
@*         border: 1px solid #673AB7; *@
@*         border-radius: 8px; *@
@*         margin-bottom: 1.5rem; *@
@*     } *@

@*     .job-card-link { *@
@*         text-decoration: none; *@
@*         color: inherit; *@
@*         display: block; *@
@*     } *@

@*     .job-actions { *@
@*         position: absolute; *@
@*         top: 1rem; *@
@*         right: 1rem; *@
@*         display: flex; *@
@*         gap: 0.5rem; *@
@*     } *@

@*     .btn-sm { *@
@*         padding: 0.25rem 0.5rem; *@
@*         font-size: 0.875rem; *@
@*     } *@
@* </style> *@
